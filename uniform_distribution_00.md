


# Равномерное распределение точек на сфере #

## Часть 1. Постановка задачи. Расчёт функционала. ##

* Аудитория: начальный уровень deep learning
* tags: ml, pytorch, tensorflow, backpropagation, function minimization, povray, vapory
* В результате прочтения: опыт применения векторизированных матричных вычислений для решения реальных задач; более полное понимание разных методов минимизации функции многих переменных, их параметров; опыт визуализации данных с помощью PovRay и vapory.

### Откуда задача ###

Акустику бывает нужно понять, в каком направлении запустить волну в кристалле. Связисту - как расположить на орбите спутники для достижения наилучшего качества связи. Метеорологу - как разместить станции слежения за погодой. Все эти задачи можно свести к поиску равномерного распределения по сфере заданного количества n точек.
Для некоторых n задача решается. Например, если n = 8, то мы можем взять куб и его вершины будут являться ответом задачи. Так же нам повезёт, если n будет равно количеству вершин икосаэдра, додекаэдра или другого платонова тела. В противном случае задача так просто не решается.
Для достаточно большого количества точек есть формула с эмпирически подобранными коэффициентами. Но есть и более универсальное, хотя и более сложное решение, которому посвящена данная статья. Разбросаем n точек случайно, а потом заставим их притягиваться к какой-то поверхности, например, к сфере и отталкиваться друг от друга. Притяжение и отталкивание определяется функцией - потенциалом. Значение функции мало - точки легли как нужно.

### Считаем потенциал ###

В школе нам рассказали две формулы. F = -kx - сила упругой деформации и F = (q1 q2) / (r^2) - сила электростатического взаимодействия. Потенциал двух точек, взаимодействующих с этими силами будет либо u_1 = k r r либо u_2 = 1 / r.
Запишем координаты n точек в виде матрицы 3xn.

pic_3n_matrix

Матрица S = x xt обладаем многими интересными свойствами и часто встречается в выкладках, связанных с теорией линейных классификаторов в ML. Если мы посмотрим на строчки матрицы X с индексами p и q как на вектора трёхмерного пространства \vec x _ p, \vec x_q то обнаружим что матрица S состоит из скалярных произведений этих векторов.

pic_s_scalar_product





